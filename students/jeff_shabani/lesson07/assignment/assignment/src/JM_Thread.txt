def import_data(db, directory_name, products_file, customers_file, rentals_file):
    '''
    Takes a directory name and three csv files as input.  Creates and populates
    three collections in MongoDB.
    '''

    products = db['products']
    customers = db['customers']
    rentals = db['rentals']

    results_dict = {}

    threads = [threading.Thread(target=_add_bulk_data, args=(results_dict,
                                                             products,
                                                             directory_name,
                                                             products_file)),
               threading.Thread(target=_add_bulk_data, args=(results_dict,
                                                             customers,
                                                             directory_name,
                                                             customers_file)),
               threading.Thread(target=_add_bulk_data, args=(results_dict,
                                                             rentals,
                                                             directory_name,
                                                             rentals_file))]

    for t in threads:
        t.start()

    for t in threads:
        t.join()

    return [results_dict['customers'], results_dict['products'], results_dict['rentals']]